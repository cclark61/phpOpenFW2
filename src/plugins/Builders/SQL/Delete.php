<?php
//******************************************************************************
//******************************************************************************
/**
 * SQL Delete Statement Class
 *
 * @package         phpopenfw/phpopenfw2
 * @author          Christian J. Clark
 * @copyright       Copyright (c) Christian J. Clark
 * @license         https://mit-license.org
 **/
//******************************************************************************
//******************************************************************************

namespace phpOpenFW\Builders\SQL;

//******************************************************************************
/**
 * SQL Delete Class
 */
//******************************************************************************
class Delete extends Statement
{
    //==========================================================================
    // Traits
    //==========================================================================
    use Traits\Where;
    use Traits\Limit;

    //==========================================================================
    // Class Memebers
    //==========================================================================
    protected $sql_type = 'delete';

    //==========================================================================
    //==========================================================================
    // Get SQL Method
    //==========================================================================
    //==========================================================================
    public function GetSQL()
    {
        //---------------------------------------------------------------------
        // Get Formatted Where Clause
        //---------------------------------------------------------------------
        // Require a where clause to prevent deleting all table rows
        //---------------------------------------------------------------------
        $where = $this->FormatWhere();
        if (!$where) {
            trigger_error("SQL Delete statement must have at least one qualifying condition.");
            return '';
        }

        //---------------------------------------------------------------------
        // Start SQL Update Statement
        //---------------------------------------------------------------------
        $strsql = "DELETE FROM {$this->table} \n{$where}";

        //---------------------------------------------------------------------
        // Limit
        //---------------------------------------------------------------------
        $this->AddLimitClause($strsql);

        //---------------------------------------------------------------------
        // Return SQL
        //---------------------------------------------------------------------
        return $strsql;
    }

}
